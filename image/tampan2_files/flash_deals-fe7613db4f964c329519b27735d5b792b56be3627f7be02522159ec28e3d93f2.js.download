"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}!function(){var t=1e3,e=60*t,n=60*e,i=24*n;window.FlashDeals=window.FlashDeals||{},window.FlashDeals.Lib=window.FlashDeals.Lib||{},window.FlashDeals.Lib={MILLIS_SECOND:t,MILLIS_MINUTE:e,MILLIS_HOUR:n,MILLIS_DAY:i}}(window),function(t){var e=t.FlashDeals;window.FlashDeals=window.FlashDeals||{},window.FlashDeals.Mixins=window.FlashDeals.Mixins||{},window.FlashDeals.Mixins.Countdown={data:function(){return{countdown:{hour:null,minute:null,second:null}}},methods:{startCountdown:function(t){var n=this,i=t.startTime,s=t.countdownTarget,o=t.finished,l=new Date(s).getTime(),a=i?new Date(i).getTime():(new Date).getTime(),r=setInterval(function(){var t=l-a,i=Math.floor(t/e.Lib.MILLIS_SECOND);n.countdown.hour=Math.floor(t/e.Lib.MILLIS_HOUR),n.countdown.minute=Math.floor(t%e.Lib.MILLIS_HOUR/e.Lib.MILLIS_MINUTE),n.countdown.second=Math.floor(t%e.Lib.MILLIS_MINUTE/e.Lib.MILLIS_SECOND),a+=e.Lib.MILLIS_SECOND,0>=i&&(clearInterval(r),o())},e.Lib.MILLIS_SECOND)}}}}(window),function(){window.FlashDeals=window.FlashDeals||{},window.FlashDeals.Mixins=window.FlashDeals.Mixins||{},window.FlashDeals.Mixins.Modal={methods:{showAppOnlyModal:function(){this.$remodal.show("modal-app-only")},closeAppOnlyModal:function(){this.$remodal.hide("modal-app-only")}}}}(window),function(t){var e=t.location,n=t.history;window.FlashDeals=window.FlashDeals||{},window.FlashDeals.Mixins=window.FlashDeals.Mixins||{},window.FlashDeals.Mixins.Navigation={data:function(){return{location:e}},methods:{back:function(){n.back()}}}}(window),function(t){var e=t.location,n=/www.|m./,i=e.origin.replace(n,"api."),s=i+"/v2/flash_deal";window.FlashDeals=window.FlashDeals||{},window.FlashDeals.API={getFlashDeals:function(){return new Promise(function(t,e){$.get({url:s+".json"}).success(t).error(e)})},getFlashDealsDetail:function(t){return new Promise(function(e,n){$.get({url:s+"/"+t+".json"}).success(e).error(n)})}}}(window);var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};!function(t){var e=t.FlashDeals,n=12;window.FlashDeals=window.FlashDeals||{},window.FlashDeals.Mixins=window.FlashDeals.Mixins||{},window.FlashDeals.Mixins.Products={data:function(){return{initialXHRStatus:null,serverTime:null,flashDeals:[],currentFlashDeals:{},activeFlashDealsID:null}},computed:{activeFlashDeals:function(){var t=this;return this.flashDeals.find(function(e){return e.id===t.activeFlashDealsID})||{}},products:function i(){var i=this.activeFlashDeals.items;return i||!this.activeFlashDeals.id||this.activeFlashDeals.isGetting?i&&(i=i.reduce(function(t,e){return e.stock_percentage=e.stock/e.flash_deal_stock*100,t.push(e),t},[])):this.getFlashDealsDetail(this.activeFlashDeals.id),i},widgetProducts:function(){if(!this.products)return[];var t=this.products.filter(function(t){return 0===t.stock});return this.products.filter(function(t){return 0!==t.stock}).concat(t).slice(0,n)}},methods:{getFlashDeals:function(){var t=this;this.initialXHRStatus="pending",this.useAPIv4?BLSecureClient.api["interface"].flashDeal.getCampaigns().then(function(e){if(t.initialXHRStatus="success",t.currentFlashDeals=e.data.active,t.serverTime=e.data.current_time,e.data.others.length>0&&(t.flashDeals=[].concat(_toConsumableArray(e.data.others)),t.activeFlashDealsID=t.flashDeals[t.flashDeals.length-1].id),t.currentFlashDeals){t.flashDeals=[].concat(_toConsumableArray(t.flashDeals.filter(function(e){return e.id!==t.currentFlashDeals.id})),[t.currentFlashDeals]),t.activeFlashDealsID=t.currentFlashDeals.id;var n=null;n="future"===t.currentFlashDeals.state?t.currentFlashDeals.start_time:t.currentFlashDeals.end_time,t.startCountdown({countdownTarget:n,startTime:t.serverTime,finished:t.getFlashDeals})}t.flashDeals=t.flashDeals.sort(function(t,e){var n=new Date(t.start_time).getTime(),i=new Date(e.start_time).getTime();return n-i})}):e.API.getFlashDeals().then(function(e){if(t.initialXHRStatus="success",t.currentFlashDeals=e.flash_deal,t.serverTime=e.time,e.other_flash_deal.length>0&&(t.flashDeals=[].concat(_toConsumableArray(e.other_flash_deal)),t.activeFlashDealsID=t.flashDeals[t.flashDeals.length-1].id),t.currentFlashDeals){t.flashDeals=[].concat(_toConsumableArray(t.flashDeals.filter(function(e){return e.id!==t.currentFlashDeals.id})),[t.currentFlashDeals]),t.activeFlashDealsID=t.currentFlashDeals.id;var n=null;n="future"===t.currentFlashDeals.state?t.currentFlashDeals.start_date:t.currentFlashDeals.end_date,t.startCountdown({countdownTarget:n,startTime:t.serverTime,finished:t.getFlashDeals})}t.flashDeals=t.flashDeals.sort(function(t,e){var n=new Date(t.start_date).getTime(),i=new Date(e.start_date).getTime();return n-i})},function(){t.initialXHRStatus="error"})},getFlashDealsDetail:function(t){var i=this;t&&!function(){var s=i.flashDeals.findIndex(function(e){return e.id===t});i.setIsGetting(s,!0),i.useAPIv4?BLSecureClient.api["interface"].flashDeal.getCampaignProductIds(t).then(function(t){var e=t.data.slice(0,n).map(function(t){return t.product_id});return BLSecureClient.api["interface"].flashDeal.getCampaignProductsAggregate(e).then(function(t){return e.map(function(e){return t.data[e]})})}).then(function(t){i.setIsGettingStatus(s,"success"),i.setItems(s,t)}):e.API.getFlashDealsDetail(t).then(function(t){i.setIsGettingStatus(s,"success"),i.setItems(s,t.flash_deal.items)},function(){i.setIsGettingStatus(s,"error")}).then(function(){i.setIsGetting(s,!1)})}()},setIsGetting:function(t,e){this.flashDeals[t]&&this.$set(this.flashDeals,t,Object.assign(this.flashDeals[t],{isGetting:e}))},setIsGettingStatus:function(t,e){this.flashDeals[t]&&this.$set(this.flashDeals,t,Object.assign(this.flashDeals[t],{isGettingStatus:e}))},setItems:function(t,e){if(this.flashDeals[t])if(this.useAPIv4){var n=e.map(function(t){return _extends({},t,{images:[t.images.small_urls[0]],stock:t.current_stock,flash_deal_stock:t.stock,original_price:t.base_price,discount_price:t.reduced_price,percentage:t.discount})});this.$set(this.flashDeals,t,Object.assign(this.flashDeals[t],{items:n}))}else this.$set(this.flashDeals,t,Object.assign(this.flashDeals[t],{items:e}))},resolveTitle:function(t){var n=t.state,i=t.start_date;if("current"===n)return"Deal Saat Ini";var s=new Date(this.serverTime),o=Date.UTC(s.getFullYear(),s.getMonth(),s.getDate())/e.Lib.MILLIS_DAY,l=new Date(i),a=Date.UTC(l.getFullYear(),l.getMonth(),l.getDate())/e.Lib.MILLIS_DAY,r=""+DateHelper.convertToDateMonthYear(l).slice(0,6),c=o-a;switch(0>c&&(c=-c),c){case 0:return"finished"===n?"Sebelumnya":"Selanjutnya";case 1:return"finished"===n?"Kemarin":"Besok";case 2:return"future"===n?"Lusa":r;default:return r}}},created:function(){this.getFlashDeals()}}}(window),function(t){var e=t.BLSecureClient,n=new RegExp(/^(((0|\+?62)8\d{8,11})|(\+60\d{8,10})|(\+65\d{8})|(\+673\d{7,10})|(\+886\d{5,9})|(\+852\d{3,11})|(\+86\d{11}))$/);window.FlashDeals=window.FlashDeals||{},window.FlashDeals.Mixins=window.FlashDeals.Mixins||{},window.FlashDeals.Mixins.QRCode={data:function(){return{phoneNumber:null}},methods:{sendAppDownloadLink:function(){var t=n.test(this.phoneNumber);t?e.api["interface"].onboarding.downloadAps({phone_number:this.phoneNumber,source:"pcv_flash_deal"}).then(function(t){var e=t.message;window.BLFlash.initByJS(e,"success")})["catch"](function(t){var e=t.errors,n=e.map(function(t){return t.message}).join(", ");window.BLFlash.initByJS(n,"error")}):window.BLFlash.initByJS("Nomor tidak valid","error")}}}}(window),function(){window.FlashDeals=window.FlashDeals||{},window.FlashDeals.Mixins=window.FlashDeals.Mixins||{},window.FlashDeals.Mixins.State={data:function(){return{ready:!1}},mounted:function(){this.ready=!0}}}(window),function(){window.FlashDeals=window.FlashDeals||{},window.FlashDeals.Filters=window.FlashDeals.Filters||{},window.FlashDeals.Filters.DigiClock={filters:{dateToDigiClock:function(t){var e=new Date(t),n=e.getHours();10>n&&(n="0"+n);var i=e.getMinutes();return 10>i&&(i="0"+i),n+":"+i},digiClock:function(t){return t||(t=0),10>t?"0"+t:t.toString()}}}}(window),function(){window.FlashDeals=window.FlashDeals||{},window.FlashDeals.Filters=window.FlashDeals.Filters||{},window.FlashDeals.Filters.Numbers={filters:{money:function(t){return integerToMoney(t,0,"Rp",".")},numbers:function(t){return integerToMoney(t,0,"",".")}}}}(window),function(t){var e=t.Vue,n=t.$,i=t.FunctionHelper,s=t.Math;e.component("v-scrollerbox",{name:"v-scrollerbox",template:'\n      <div class="c-scrollerbox c-scrollerbox__wrapper">\n        <div class="c-scrollerbox__arrow c-scrollerbox__arrow--left" v-bind:class="[navClass, navClassModifier]" v-if="infiniteLoop || canScrollPrev" @click="scrollPrev"></div>\n        <div class="c-scrollerbox__arrow c-scrollerbox__arrow--right" v-bind:class="[navClass, navClassModifier]" v-if="infiniteLoop || canScrollNext" @click="scrollNext"></div>\n        <div class="c-scrollerbox__clip" :class="clipClass">\n          <div class="c-scrollerbox__content " :style="contentStyle" :class="{\'c-scrollerbox__content--with-transition\': !infiniteLoop}">\n            <slot></slot>\n          </div>\n        </div>\n        <template v-if="$slots.outerSlot">\n          <div class="c-scrollerbox__clip c-scrollerbox__clip--outer" :style="clipStyleOuter" :class="clipOuterClass">\n            <div class="c-scrollerbox__content " :style="contentStyle" :class="{\'c-scrollerbox__content--with-transition\': !infiniteLoop}">\n              <slot name="outerSlot"></slot>\n            </div>\n          </div>\n        </template>\n        <div class="c-scrollerbox__dots" :class="[dotClass, dotClassModifier]" v-if="showDotNav">\n          <span class="c-scrollerbox__dot u-clearfix" v-for="i in realItemTotal" :class="{\'is-active\': dotActive(i)}" @click="moveToItem($event, i)">&nbsp;</span>\n        </div>\n      </div>\n    ',props:{scrollOffset:{type:Number,"default":1},contentWindow:{type:Number,"default":6},collection:{type:Array,"default":function(){return[]}},navModifier:{type:Array,"default":function(){return[]}},navClass:{type:String,"default":""},clipClass:{type:String,"default":""},clipStyleOuter:{type:Object,"default":function(){return{}}},clipOuterClass:{type:String,"default":""},autoplay:{type:Boolean,"default":!1},infiniteLoop:{type:Boolean,"default":!1},showDotNav:{type:Boolean,"default":!1},dotModifier:{type:Array,"default":function(){return[]}},dotClass:{type:String},transitionDuration:{type:Number,"default":800},panelType:{type:String,"default":""},pageFrom:{type:String,"default":""}},data:function(){return{contentXPos:0,contentOffset:0,mouseEnter:!1,lastScrollDirection:1,abCheckNext:!0,panelIndex:0}},mounted:function(){var t=this,e=this;n(window).on("resize.v-scrollerbox",i.debounce(function(){e.repositionContent()},400)),n(this.$el).on("mouseenter.v-scrollerbox",function(){t.mouseEnter=!0}),n(this.$el).on("mouseleave.v-scrollerbox",function(){t.mouseEnter=!1}),this.infiniteLoop&&(this.contentOffset=1,this.repositionContent()),this.autoplay&&this.startAutoPlay()},computed:{realItemTotal:function(){return this.infiniteLoop?this.collection.length-2:this.collection.length},contentStyle:function(){return{transform:"translateX("+this.contentXPos+"px)","transition-duration":this.transitionDuration/1e3+"s"}},canScrollNext:function(){return this.canScroll(1)},canScrollPrev:function(){return this.canScroll(-1)},navClassModifier:function(){return this.navModifier.reduce(function(t,e){var n=t;return n.push("c-scrollerbox__arrow--"+e),n},[]).join(" ")},dotClassModifier:function(){return this.dotModifier.reduce(function(t,e){var n=t;return n.push("c-scrollerbox__dots--"+e),n},[]).join(" ")}},methods:{moveToItem:function(t,e){var n=this.infiniteLoop?e:e-1;t.target.classList.contains("is-active")||(this.lastScrollDirection=n-this.contentOffset,this.lastScrollDirection=this.lastScrollDirection/s.abs(this.lastScrollDirection),this.contentOffset=n,this.repositionContent())},dotActive:function(t){var e=this.infiniteLoop?t:t-1,n=e===this.contentOffset,i=this.infiniteLoop&&1===e&&this.contentOffset===this.collection.length-1,s=this.infiniteLoop&&e===this.realItemTotal&&0===this.contentOffset;return n||s||i},startAutoPlay:function(){var t=this;setInterval(function(){t.canScrollNext&&!t.mouseEnter&&t.scroll(t.lastScrollDirection)},6e3)},scroll:function(t){var e=this;if(this.infiniteLoop){var n=this.collection.length-1;1===this.contentOffset&&0>t?(this.contentXPos=-this.getScrollUnit()*n,this.$el.querySelector(".c-scrollerbox__content").style["transition-duration"]="0s",this.$el.querySelector(".c-scrollerbox__content").style.transform="translateX("+this.contentXPos+"px)",this.contentOffset=this.collection.length-1):this.contentOffset===n&&t>0&&(this.contentXPos=-this.getScrollUnit(),this.$el.querySelector(".c-scrollerbox__content").style["transition-duration"]="0s",this.$el.querySelector(".c-scrollerbox__content").style.transform="translateX("+this.contentXPos+"px)",this.contentOffset=1)}setTimeout(function(){if(e.$el.querySelector(".c-scrollerbox__content").style["transition-duration"]=e.transitionDuration/1e3+"s",e.canScroll(t)){var n=e.getScrollUnit(),i=e.infiniteLoop||e.getAllowedScrollOffset(t);e.panelIndex+=t,e.contentOffset=e.contentOffset+t*i,e.contentXPos+=-1*t*n*i,e.$emit("scrolled",e.panelIndex)}},0)},scrollNext:function(){var t=this;this.throttledNext=this.throttledNext||i.throttle(function(){t.lastScrollDirection=1,t.scroll(1)},this.transitionDuration+100,{trailing:!1}),this.throttledNext.call(this)},scrollPrev:function(){var t=this;this.throttledPrev=this.throttledPrev||i.throttle(function(){t.lastScrollDirection=-1,t.scroll(-1)},this.transitionDuration+100,{trailing:!1}),this.throttledPrev.call(this)},canScroll:function(t){var e=this;return this.infiniteLoop||function(){var n=e.contentOffset+t,i=e.collection.length-e.contentWindow;return n>=0&&i>=n}()},getScrollUnit:function(){var t=this.$el.querySelector(".js-scrollerbox__item");return t?t.getBoundingClientRect?t.getBoundingClientRect().width:t.clientWidth:0},getAllowedScrollOffset:function(t){if(t>0){var e=this.collection.length-this.contentOffset-this.contentWindow;return s.min(this.scrollOffset,e)}return s.min(this.scrollOffset,this.contentOffset)},repositionContent:function(){this.contentXPos=-1*this.contentOffset*this.getScrollUnit()}}})}(window);var Remodal={template:'\n    <transition name="c-remodal-transition">\n      <div class="c-remodal" :class="remodalSizingClass()" v-if="visible" :style="{height: window.height + \'px\'}">\n        <div\n          @mousedown.stop="onBackgroundClick"\n          @touchstart.stop="onBackgroundClick"\n          class="c-remodal__wrapper">\n          <div class="c-remodal__content" ref="modal">\n            <button\n              v-if="showCloseBtn"\n              @click="toggle(false)"\n              class="c-remodal__close"\n              type="button" v-html="\'&times;\'"></button>\n\n            <div\n              @mousedown.stop\n              @touchstart.stop\n              class="c-modal c-modal--full">\n              <div class="c-modal__head" v-if="title">\n                <div class="c-modal__title">{{ title }}</div>\n              </div>\n              <div class="c-modal__content">\n                <slot></slot>\n              </div>\n              <div class="c-modal__footer" v-if="hasFooter">\n                <slot name="footer"></slot>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </transition>\n  ',name:"remodal",props:{name:{type:String,required:!0},title:{type:String},size:{type:String,"default":"default",validator:function(t){var e=["small","default","medium","large"],n=e.indexOf(t);return-1!==n}},hasFooter:{type:Boolean,"default":!1},showCloseBtn:{type:Boolean,"default":!0},overlayClickToClose:{type:Boolean,"default":!0},delay:{type:Number,"default":0}},data:function(){return{visible:!1,window:{width:0,height:0}}},watch:{visible:function(t){var e=this;t?setTimeout(function(){e.$nextTick(function(){e.callAfterEvent(!0)})},this.delay):setTimeout(function(){e.$nextTick(function(){e.callAfterEvent(!1)})},this.delay)}},methods:{toggle:function(t){var e=this.visible?"before-close":"before-open",n=!1,i=function(){n=!0},s=this.genEventObject({stop:i,state:t});this.$emit(e,s),n||(t?document.documentElement.style.overflowY="hidden":document.documentElement.style.overflowY="scroll",this.visible=t)},genEventObject:function(t){var e={name:this.name,timestamp:Date.now(),ref:this.$refs.modal};return Object.assign(e,t||{})},callAfterEvent:function(t){var e=t?"opened":"closed",n=this.genEventObject({state:t});this.$emit(e,n)},onBackgroundClick:function(){this.overlayClickToClose&&this.toggle(!1)},onWindowResize:function(){this.window.width=window.innerWidth,this.window.height=window.innerHeight},remodalSizingClass:function(){return"default"!==this.size?"c-remodal--"+this.size:""}},beforeMount:function(){var t=this;window.VueRemodalPlugin.event.$on("toggle",function(e,n){e===t.name&&("undefined"==typeof n&&(n=!t.visible),t.toggle(n))}),window.addEventListener("resize",this.onWindowResize),this.onWindowResize()}};window.VueRemodalPlugin={install:function(t){this.installed||(this.installed=!0,this.event=new t,t.prototype.$remodal={show:function(t){window.VueRemodalPlugin.event.$emit("toggle",t,!0)},hide:function(t){window.VueRemodalPlugin.event.$emit("toggle",t,!1)},toggle:function(t){window.VueRemodalPlugin.event.$emit("toggle",t,void 0)}},t.component("remodal",Remodal))}},function(t){var e=t.FlashDeals,n=t.VueRemodalPlugin,i=".v__flash-deals",s=$(i).data("useapiv4"),o=function(){Vue.use(n),window.FlashDeals=window.FlashDeals||{},window.FlashDeals.VM=new Vue({el:i,name:"VFlashDeals",mixins:[e.Filters.Numbers,e.Filters.DigiClock,e.Mixins.State,e.Mixins.Navigation,e.Mixins.Products,e.Mixins.Modal,e.Mixins.Countdown,e.Mixins.QRCode],data:function(){return{useAPIv4:s}}})};o(),document.addEventListener("page:change",function(){$(i).length&&o()})}(window),function(){}.call(this);
//# sourceMappingURL=/ast/maps/flash_deals-56f5049879187058148363ddb9c77d0d2c535f607696503a3672b8bfdc0e9791.js.map
